<!DOCTYPE html>
<html>
<head>
    <!-- Hardcoded part. TODO: please fix this -->
    <title>Naviigo</title>
    <meta name="description" content="Naviigo SLOGAN"/>
    <!-- End -->
    <link rel="canonical" href="{{ .Permalink }}index.html"/>
    <meta name="robots" content="noindex">
    <meta charset="utf-8"/>
    <noscript>
        <meta http-equiv="refresh" content="0; url={{ .Permalink }}index.html"/>
    </noscript>
    <script>
        ;(function () {
            // Only do i18n at root,
            // otherwise, redirect immediately
            if (window.location.pathname !== '/') {
                window.location.replace('{{ .Permalink }}index.html')
                return
            }

            var getFirstBrowserLanguage = function () {
                var nav = window.navigator,
                    browserLanguagePropertyKeys = ['language', 'browserLanguage', 'systemLanguage', 'userLanguage'],
                    i,
                    language

                if (Array.isArray(nav.languages)) {
                    for (i = 0; i < nav.languages.length; i++) {
                        language = nav.languages[i]
                        if (language && language.length) {
                            return language
                        }
                    }
                }

                // support for other well known properties in browsers
                for (i = 0; i < browserLanguagePropertyKeys.length; i++) {
                    language = nav[browserLanguagePropertyKeys[i]]
                    if (language && language.length) {
                        return language
                    }
                }
                return 'en'
            }

            const referrer = document.referrer ? new URL(document.referrer):undefined;
            return
            if(referrer && referrer.hostname === window.location.hostname) {
                window.location.replace(referrer.pathname.match("^(\\/[^\\/?]+)")[1]+"/index.html")
            }
            else {
                var preferLang = getFirstBrowserLanguage()
                if (preferLang.indexOf('it') !== -1) {
                    // visitor prefers Italian
                    window.location.replace('/it/index.html')
                } else if (preferLang.indexOf('de') !== -1) {
                    // visitor prefers Italian
                    window.location.replace('/de/index.html')
                } else if (preferLang.indexOf('fr') !== -1) {
                    // visitor prefers Italian
                    window.location.replace('/fr/index.html')
                } else {
                    // fallback to English
                    window.location.replace('/en/index.html')
                }
            }
        })()
    </script>
</head>
<body>
<h1>Rerouting</h1>
<p>You should be rerouted in a jiff, if not, <a href="{{ .Permalink }}index.html">click here</a>.</p>
</body>
</html>
